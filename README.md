# –ö–∞—Ä—Ç–∞ –°—É–ø Telegram Bot

Telegram –±–æ—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–∞–ª–∞–Ω—Å–∞ –∏ –∏—Å—Ç–æ—Ä–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∫–∞—Ä—Ç—ã –ö–∞—Ä—Ç–∞ –°—É–ø.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üí≥ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ –∫–∞—Ä—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úçÔ∏è –í–≤–æ–¥ –∫–æ–¥–∞ –∫–∞—Ä—Ç—ã (13 —Ü–∏—Ñ—Ä, –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 2001)
- üí∞ –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞ –∫–∞—Ä—Ç—ã
- üìä –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- üîÑ –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ –∫–∞—Ä—Ç—ã
- üì± –£–¥–æ–±–Ω–æ–µ –º–µ–Ω—é —Å –∫–Ω–æ–ø–∫–∞–º–∏
- üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞ (rate limiting)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–¥–∞ –∫–∞—Ä—Ç—ã

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- NestJS
- TypeScript
- Telegraf (Telegram Bot API)
- TypeORM
- PostgreSQL
- Docker

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
npm install
```

2. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.example`:
```bash
cp .env.example .env
```

3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ `.env`:
```env
TELEGRAM_BOT_TOKEN=your_bot_token_here
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_USER=postgres
DATABASE_PASSWORD=postgres
DATABASE_NAME=karta_soup
NODE_ENV=development
```

4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ PostgreSQL (–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Docker):
```bash
docker run -d \
  --name postgres \
  -e POSTGRES_PASSWORD=postgres \
  -e POSTGRES_DB=karta_soup \
  -p 5432:5432 \
  postgres:15-alpine
```

5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
```bash
npm run start:dev
```

### –ó–∞–ø—É—Å–∫ —Å Docker

1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env`:
```bash
cp .env.example .env
```

2. –£–∫–∞–∂–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –≤ `.env`:
```env
TELEGRAM_BOT_TOKEN=your_bot_token_here
```

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:
```bash
docker-compose up -d
```

4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
```bash
docker-compose logs -f app
```

### –î–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä:
```bash
scp -r . user@your-server:/path/to/app
```

2. –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ —Å–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª —Å –≤–∞—à–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ:
```bash
docker-compose up -d
```

## –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

- `/start` - –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º
- `/balance` - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–ª–∞–Ω—Å
- `/changecode` - –ò–∑–º–µ–Ω–∏—Ç—å –∫–æ–¥ –∫–∞—Ä—Ç—ã
- `/help` - –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
src/
‚îú‚îÄ‚îÄ bot/
‚îÇ   ‚îú‚îÄ‚îÄ bot.module.ts       # –ú–æ–¥—É–ª—å –±–æ—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ bot.update.ts       # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ –∏ —Å–æ–æ–±—â–µ–Ω–∏–π
‚îú‚îÄ‚îÄ entities/
‚îÇ   ‚îî‚îÄ‚îÄ user.entity.ts      # –°—É—â–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îú‚îÄ‚îÄ interfaces/
‚îÇ   ‚îî‚îÄ‚îÄ balance.interface.ts # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –¥–ª—è API
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ karta-soup.service.ts # –°–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API –ö–∞—Ä—Ç–∞ –°—É–ø
‚îÇ   ‚îî‚îÄ‚îÄ user.service.ts      # –°–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
‚îú‚îÄ‚îÄ app.module.ts           # –ì–ª–∞–≤–Ω—ã–π –º–æ–¥—É–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îî‚îÄ‚îÄ main.ts                 # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
```

## API –ö–∞—Ä—Ç–∞ –°—É–ø

–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—É–±–ª–∏—á–Ω—ã–π API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –±–∞–ª–∞–Ω—Å–µ:
```
GET https://meal.gift-cards.ru/api/1/cards/{code}?limit=100
```

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
